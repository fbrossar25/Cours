\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[francais]{babel}
\usepackage[a4paper, bottom=3.5em, top=3em]{geometry}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage[hidelinks]{hyperref}

\title{Algorithmes de recherche - TD}
\begin{document}
	
	\maketitle
	\tableofcontents
	\listoffigures
	\newpage
	\section{Intros et définitions}
	
	Recherche de mots dans un texte, algorithme exact, toutes les solutions et pas d'heuristique.\\
	
	\subsection{Périodicité et bords}
	
	Quelles sont les périodes du mot x = aabaabaa et pér(x) de x ?
	\begin{align*}
		p = 3 &\Rightarrow \forall 0 \leq i \leq 8 - 3 - 1 \Rightarrow i \in [0, 4]\\
		p = 6 &\Rightarrow \forall 0 \leq i \leq 8 - 6 - 1 \Rightarrow i \in [0, 1]\\
		p = 7 &\Rightarrow \forall 0 \leq i \leq 8 - 7 - 1 \Rightarrow i \in [0, 0]\\
		p = 8 &\Rightarrow \text{Admis}\\
		\text{pér}(x) &= 3\\
	\end{align*}
	\\
	
	Quelles sont les bords du mot x = aabaabaa ?\\
	$\Rightarrow$ $\epsilon$, a, aa et aabaa.\\
	
	Quelle est la relation entre les notions de bords et périodes ?\\
	Les notions de bords et de périodes sont duales.\\
	
	Application avec la bord aa.\\
	Le bord correspond à la période 6, qui correspond à $|aabaabaa| - |aa|$.\\
	
	Quel est le bord du mot aabaabaa ?\\
	C'est aabaa.\\
	
	Quelles sont les suites des bords et des périodes du mot x = aabaabaa ?\\
	Suite des bords : (aabaa, aa, a, $\epsilon$), car LE bord de aaabaabaa est aabaa (le bord le plus long)\\
	Suite des périodes : (3, 6, 7, 8), car \begin{align*}
		3 &= |x| - |Bord(x)|\\
		&= |aabaabaa| - |aabaa|\\
		&= 8 - 5\\
		\text{ET}&\\
		6 &= |x| - |Bord^{2}(x)|\\
		&= |aabaabaa| - |aa|\\
		&= 8 - 2
	\end{align*}\\
	\newpage
	\subsection{Puissance et primitive}
	
	Donner un exemple de mots x et y vérifiant $x^m = y^n$ sur un alphabet à 2 lettres ?\\
	Soit x = ab et y = abab $\Rightarrow x^2 = y^1$\\
	
	Donner un exemple de mot primitif et de non-primitif de longueurs supérieures à 3.\\
	Le mot abaab st primitif.\\
	Le mot baba = $(ba)^2$ n'est pas primtif.\\
	
	Vérifier la proposition 'Un mot non vide est primitif si et seulement s'il un facteur de son carré qu'en tant que préfix et suffixe', avec les mots abaab et baba.\\
	Le mot abaab est primitif car abaab est uniquement un facteur de abaab . abaab en tant que préfixe et suffixe.\\
	Le mot baba n'est pas primitif car baba n'est pas uniquement un facteur de baba . baba qu'en tant que préfixe et suffixe, par exemple ba . baba . ba.\\
	
	Donner un exemple de mots conjugués.\\
	Avec A = {a, b}, x = abbaba, y = abaabb, on a u = abb et v = aba.\\
	Avec B = {A, C, G, T}, x = AGTACGTTA , y = ACGTTAAGT, on a u = AGT et v = ACGTTA.\\
	Avec $B^3$ = {AAA, AAC, ..., TTT}, x = TTTACG , y = ACGTTT , on a u = TTT, v = ACG.\\
	
	Donner un exemple de mot z avec des mots conjugués x et y.\\
	Soit x = AAC, y = ACA, on a z = A car x = z . AC et y = AC . z
	\newpage
	\section{Mots particuliers}
	
	\subsection{Mots de fibonacci}
	
	\begin{center}
		\begin{tabular}{|c|c|c|}
			\hline
			n & $F_n$ & $f_n$\\ 
			\hline 
			3 & 2 & ab \\ 
			\hline 
			4 & 3 & aba \\ 
			\hline 
			5 & 5 & abaab \\ 
			\hline 
			6 & 8 & abaababa \\ 
			\hline 
			7 & 13 & abaababaabaab \\ 
			\hline 
			8 & 21 & abaababaabaababaababa \\ 
			\hline 
		\end{tabular} 
	\end{center}

	Propriété remarquable : ???\\
	
	Démontrer $\phi^{n}(a) = f_{n+2}$.
	\begin{align*}
		\phi^{1}(a) &= ab = f_{3}\\
		\phi^{2}(a) &= \phi^{1}(\phi(a))\\
		&= \phi^{1}(ab)\\
		&= \phi(a) . \phi(b)\\
		&= ab . a = aba\\
		&= f_{4}\\
		\phi^{n}(a) &= \phi^{n-1}(\phi(a))\\
		&= \phi^{n-1}(ab)\\
		&= \phi^{n-1}(a) . \phi^{n-1}(b)\\
		&= f_{n+1} . \phi^{n-2}(\phi(b))\\
		&= f_{n+1} . \phi^{n-2}(a)\\
		&= f_{n+1} . f_{n}\\
		&= f_{n+2}\\
	\end{align*}
	
	Démontrer la proposition du palindrome de fibonacci avec $n \geq 3$.\\
	\begin{align*}
		f_3 &= ab, u = \epsilon \Rightarrow palindrome (trivial)\\
		f_4 &= aba, u = a \Rightarrow palindrome (trivial)\\
		f_5 &= abaab, u = aba \Rightarrow palindrome car \\
	\end{align*}
	
	Pour tout $n \geq 5$, on a $f_n = f_{n-1} . f_{n-2} = f_{n-2} . f_{n-3} . f_{n-2}$.\\
	
	Si n est impair alors, par hypothèse de récurrence alors $f_{n-2}$ est impair et $f_{n-3}$ est pair. Donc $f_{n-2} = u_1ab$ et $f_{n-3} = u_2ba$ avec $u_1$ et $u_2$ des palindromes.\\
	Donc, $f_n = u_1abu_2bau_1ab$.\\
	Mais $u_1$ et $u_2$ sont des palindromes, donc $u_1abu_2bau_1$ est également un palindrome.\\
	En posant $u = u_1abu_2bau_1$, on a alors $f_n = uab$ où u est un palindrome.\\
	
	Démonstration de façon similaire si n est pair.
	\newpage
	\subsection{Les mots de DE BRUIJN}
	
	Donner tous les mots de DE BRUIJN d'ordre $k = 1$ dans l'alphabet $A = {a,b}$.\\
	Les mots ab et ba sont les deux seuls mots de DE BRUIJN d'ordre 1.\\
	
	Pour k = 3 :\\
	$A^3 = {aaa, aab, ..., bbb}$\\
	Introuvables à la man car trop compliqués. Ex : aaababbbaa car ses facteurs de longueur 3 sont les 8 mots de $A^3$ : aaa, aab, aba, abb, baa, bab, bba, bbb. Chaque mot n'apparait qu'une et une seule fois dans ce mot ET tout les mots de $A^3$ y apparaissent.

	\begin{figure}[ht]
		\centering
		\includegraphics[width=10cm]{"DE BRUIJN ordre 3".png}
		\caption{Automate DE BRUIJN ordre 3 avec A = \{a,b\}}
	\end{figure}
	
	
	Exactement 2 flèches sortent de chacun des états, l'une étiqutée par a, l'autre par b, et exactement 2 flèches entrent dans chacun des états, toutes 2 étiquetées par la même lettre.
	Il faut passer par toutes les flèches en commençant et terminant par le même état.\\
	
	Longueur d'un mot de DE BRUIJN d'ordre k = f(k) ?\\
	$2^k + (k-1)$
	
	\newpage
	
	\section{Automates de localisation}
	
	\subsection{Arbre d'un dictionnaire}
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=13cm]{"Arbre d'un dictionnaire".png}
		\caption{Automate A(X) reconnaissant X = \{aa, abaaa, abab\}}
	\end{figure}

	\subsection{Localisation de plusieurs mots}
	
	\begin{align*}
		h(b) &= \epsilon \Rightarrow \text{Tout ce qui se finit par b va vers }\epsilon\\
		h(a) &= a\\
		h(aa) &= aa\\
		h(ab) &= ab\\
		h(aaa) &= aa\\
		h(aab) &= ab\\
		h(aba) &= aba\\
		h(abb) &= \epsilon\\
	\end{align*}
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=15cm]{"Arbre de localisation".png}
		\caption{Automate D(X) reconnaissant X = \{aa, abaaa, abab\}}
	\end{figure}
	\newpage
	\begin{figure}[ht]
		\centering
		\includegraphics[width=15cm]{"Arbre de localisation 2".png}
		\caption{Automate D(X) reconnaissant X = \{ab, babb, bb\} sur A = \{a, b, c\}}
	\end{figure}
	Sur ce dernier automate, les flèches étiquetées 'c' vont toutes vers l'état $\epsilon$.\\


	\subsection{Construction de l'automate-dictionnaire}

	Localisation des mots $X = {ab, babb, bb}$ sur $A = {a,b,c}$ sur le texte $y = cbabba$.\\
	Utilisation de l'algorithme LOCALISATION(X, y) sur l'automate D(X) fait précédemment.\\
	\begin{center}
		\begin{tabular}{|c|c|c|c|}
			\hline
			j & $y[j]$ & Etat r & Mot\\
			\hline 
			 &  & $\epsilon$ &\\ 
			\hline 
			0 & c & $\epsilon$ &\\ 
			\hline
			1 & b & b &\\
			\hline
			2 & a & ba &\\
			\hline
			3 & b & bab & Occurence de ab\\
			\hline
			4 & b & babb & Occurence de babb et bb\\
			\hline
			5 & a & ba &\\
			\hline
		\end{tabular} 
	\end{center}
	La colonne Mot contient la liste des mots reconnus, si l'état r appartient aux états terminaux de D(X).\\
	
	\newpage
	
	\subsection{Automate avec fonction de suppleance}
	
	\begin{figure}[ht]
		\centering
		\includegraphics[width=15cm]{"Automate avec fonction de suppleance".png}
		\caption{Automate DS(X) reconnaissant X = {aa, abaaa, abab} sur A = \{a, b\}}
		\label{DS(X)}
	\end{figure}

	\subsection{Automate avec optimisation de la fonction de suppleance}
	
	Avec l'automate DS(X) (page \pageref{DS(X)}), donner des exemples d'ensembles Suivant(u) avec $u = abaa \text{ (état abaa)}$.\\
	\begin{align*}
		Suivant(u) &= \{a\}\\
		f(u) &= aa\\
		Suivant(f(u)) &= Suivant(aa) = \emptyset\\
		&\Rightarrow \text{car } \{a\} \Leftrightarrow \{a\} \cup \emptyset \\
		f(f(u)) &= f(aa) = a\\
		Suivant(f(f(u))) &= Suivant(a) = \{a, b\}\\
		&\Rightarrow \text{fin car } Suivant(a) \notin Suivant(aa)\\
		&\Rightarrow \text{g: état abaa} \rightarrow \text{état a}\\
	\end{align*}
	Exemple avec $u = aba \text{ (état 4)}$.\\
	\begin{align*}
		Suivant(u) &= \{a, b\}\\
		f(u) &= a\\
		Suivant(a) &= \{a, b\}\\
		f(f(u)) &= \epsilon\\
		Suivant(\epsilon) &= \{a\}\\
		&\Rightarrow \text{g: état aba} \rightarrow \text{état }\epsilon\\
	\end{align*}
	
	\newpage
	
	\section{Alignements de mots}
	
	\subsection{Comparaison de mots}
	
	Démontrer que la distance préfixe est bien une distance.
	\paragraph{Positivité :}
	$d_{préf}(u,v) \geq 0$ car $lpc(u,v) \leq min(|u|,|v|)$
	\paragraph{Séparation :}
	Si $ u = v$ alors $lpc(u,v) = |u| = |v|$ et $d_{préf}(u,v) = 0$ et réciproquement.
	\paragraph{Symétrie :}
	$d_{préf}(u,v) = d_{préf}(v,u)$ : évident
	\paragraph{Inégalité triangulaire :}
	$d_{préf}(u,v) \leq d_{préf}(u,w) + d_{préf}(w,v)$ pour tout $w \in A*$\\
	car
	\begin{align*}
		d_{préf}(u,w) + d_{préf}(w,v) &= |u| + |w| - 2 * lpc(u,w) + |v| + |w| - 2 * lpc(v,w)\\
		&= |u| + |v| - 2 * min(|lpc(u,w)|,|lpc(v,w|)\\
		&+ 2 * |w| - 2 * max(|lpc(u,w)|,|lpc(v,w|)\\
		&\geq |u| + |v| - 2 * |lpc(u,v)| + 2(|w| - max(|lpc(u,w)|,|lpc(v,w)|)
		&\geq |u| + |v| - 2 * |lpc(u,v)|
	\end{align*}
	
	Donner la suite des opérations élémentaires pour passer de $x = ACGA$ à \\
	$y = ATGCTA$ en supposant pour toutes lettres $a,b \in A$ les coûts suivants :
	\begin{itemize}
		\item $Sub(a,a) = 0$ et $Sub(a,b) = 1$ pour $a \neq b$
		\item $Dé(a) = Ins(a) = 1$
	\end{itemize}
	\begin{center}
		\begin{tabular}{|c|c|c|}
			\hline 
			Opération &  Mot résultant &  Coût \\ 
			\hline 
			Mot initial ACGA &  ACGA &  X \\ 
			\hline 
			Sub(A,A) & \textbf{A}CGA & 0 \\ 
			\hline 
			Sub(C,T) & A\textbf{T}GA & 1 \\ 
			\hline 
			Sub(G,G) & AT\textbf{G}A & 0 \\ 
			\hline 
			Ins(C) & ATG\textbf{C}A & 1 \\ 
			\hline 
			Ins(T) & ATGC\textbf{T}A & 1 \\ 
			\hline 
			Sub(A,A) & ATGCT\textbf{A} & 0 \\
			\hline 
			Mot final & ATGCTA & X \\ 
			\hline 
		\end{tabular} 
	\end{center}
	
	\subsection{Alignements}
	
	L'alignement global c'et un alignement qui cherche a aligner, pour deux mots, la première lettre de x avec la première de y, et la dernière de x avec la dernière de y.
	
	Attention x est en haut et y est bas !!!
	
	Donner les paires alignées et leurs coûts pour passer de $x = ACGA$ à $y = ATGCTA$\\
	Avec les même coûts que précédemment.
	\begin{center}
		\begin{tabular}{|c|c|c|}
			\hline 
			Opération &  Paire alignée &  Coût \\
			\hline 
			Sub(A,A) & (A,A) & 0 \\ 
			\hline 
			Sub(C,T) & (C,T) & 1 \\ 
			\hline 
			Sub(G,G) & (G,G) & 0 \\ 
			\hline 
			Ins(C) & (-,C) & 1 \\ 
			\hline 
			Ins(T) & (-,T) & 1 \\ 
			\hline 
			Sub(A,A) & (A,A) & 0 \\
			\hline 
		\end{tabular} 
	\end{center}

	\[
		\left(
		\begin{tabular}{cccccc}
			A&C&G&-&-&A\\
			A&T&G&C&T&A\\
		\end{tabular}
		\right)
	\]
	\newpage
	Donner le graphe d'édition G(ACGA, ATGCTA) de x = ACGA à y = ATGCTA. Donner l'alignement optimal.
	\begin{center}
		\begin{tabular}{|c|c c c c c c c|}
			\hline
			G&y&A&T&G&C&T&A\\
			\hline
			x&(-1,-1)&&&&&&\\
			A&&(0,0)&&&&&\\
			C&&&(1,1)&&&&\\
			G&&&&(2,2)&(2,3)&(2,4)&\\
			T&&&&&&&(3,5)\\
			\hline
		\end{tabular}
	\end{center}
	
	Normalement, il faut tout compléter mais j'ai la flemme.
	Dans le tableau :
	\begin{itemize}
		\item Délétion $\rightarrow$ case verticale
		\item Insertion $\rightarrow$ case à droite
		\item Substitution $\rightarrow$ case en diagonale
	\end{itemize}

	\subsection{Alignement optimal}

	Calcul de la distance d'édition entre les 2 mots x = ACGA et y = ATGCTA sachant :
	\begin{itemize}
		\item Matrice de substitution Sub avec Sub(a,b) = 1 (a $\neq$ b) et Sub(a,a) = 0
		\item Vecteurs de délétion et d'insertion avec Dél(a) = Ins(a) = 1
	\end{itemize}

	\begin{center}
		\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
			\hline
			T&j&-1&0&1&2&3&4&5\\
			\hline
			i&/&y[j]&A&T&G&C&T&A\\
			\hline
			-1&x[i]&0&1&2&3&4&5&6\\
			\hline
			0&A&1&0&1&2&3&4&5\\
			\hline
			1&C&2&1&1&2&2&3&4\\
			\hline
			2&G&3&2&2&1&2&3&4\\
			\hline
			3&A&4&3&3&2&2&3&3\\
			\hline
		\end{tabular}
	\end{center}

\end{document}