\documentclass[11pt,a4paper]{article}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{ae,lmodern}
\usepackage[francais]{babel}
\usepackage[fleqn]{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{graphicx}
\usepackage{verbatim}
\usepackage{listings}
\usepackage{fullpage}
\usepackage[dvipsnames]{xcolor}

\newcommand{\circled}[1]{\textcircled{\raisebox{-0.9pt}{#1}}}


\title{Sémantique TD3}

\newcommand{\ra}{\rightarrow}
\newcommand{\bb}[1]{\mathbb{#1}}
\newcommand{\llbr}{\llbracket}
\newcommand{\rrbr}{\rrbracket}

\begin{document}
	\section*{Sémantique dénotationnelle}
	\subsection*{Environnements}
	\begin{tabular}{|c|c|}
		\hline 
		Nom des variables & Valeur \\ 
		\hline 
		x & 4 \\ 
		\hline 
		y & 5 \\ 
		\hline 
	\end{tabular}
	\begin{align*}
		\sigma ,{\sigma }^{\prime }\ \ \ \sigma \left[x{\to }4\right]\\
		  \llbr x*x - 4*y+z  \rrbr (\sigma) &=   \llbr x*x  \rrbr (\sigma) -   \llbr 4*y*z  \rrbr (\sigma)\\
		\text{liste de variables x y z}&\\
		&=   \llbr x  \rrbr (\sigma) *   \llbr x  \rrbr (\sigma) -   \llbr 4  \rrbr \sigma*  \llbr y  \rrbr \sigma*  \llbr z  \rrbr \sigma\\
		&= \sigma(x) * \sigma(x) - 4 * \sigma(y) * \sigma(z)\\
	\end{align*}
	\begin{align*}
		x,y,z &\to &t,u,v,w\\
		\sigma &\to &\sigma &\ \ \ \text{approche impérative}\\
		\sigma &\to &int * int * int * int &\ \ \ \text{approche fonctionnelle}
		\text{il à tout effacé ce con !}
	\end{align*}
	Soit $e$ une expression :
	\begin{description}
		\item[aff] $  \llbr x := e  \rrbr (\sigma) = \sigma[x \to   \llbr e  \rrbr (\sigma)]$
		\item[seq]  $  \llbr I, J  \rrbr (J) =   \llbr J  \rrbr  o   \llbr I  \rrbr (\sigma) =   \llbr J  \rrbr (  \llbr I  \rrbr (\sigma))$
		\item[condition] $  \llbr if\ b then\ i1 else\ i2  \rrbr (\sigma) =$
		$\begin{cases}
			  \llbr i1  \rrbr (\sigma) & si\   \llbr b  \rrbr (\sigma) = true\\
			  \llbr i2  \rrbr (\sigma) & sinon\\
		\end{cases}$
		\item[while] $  \llbr while\ b do\ S  \rrbr (\sigma) =$
		$\begin{cases}
			  \llbr S; while\ b do\ S  \rrbr (\sigma) si\   \llbr b  \rrbr (\sigma) = true\\
			\sigma sinon\\
		\end{cases}$
	\end{description}
	\newpage
	\section{Expressions, instructions}
	\subsection{Question 2}
	\begin{align*}
		  \llbr tmp := x; x := y;   \rrbr \\
		\text{demander a dedele}\\
	\end{align*}
	\subsection{Question bonus !!}
	1) Écrire l'échange de 2 variables entières sans utiliser de variables intermédiaires, uniquement avec des additions et des soustractions.
	
	2) Vérifier en calculant la sémantique que c'est bien un échange.
	\\\\\\
	2 variable x et y\ \ \   $x_{0}, y_{0}$
	\begin{align*}
		x &:= x + y;\\
		y &:= x - y;\\
		x &:= x - y;\\
	\end{align*}
	$\sigma(x) = x_{0} \\ \sigma(y) = y_{0}$
	\begin{align*}
		  \llbr x := x + y; y := x - y; x := x - y  \rrbr (\sigma) &=   \llbr y := x - y; x := x - y  \rrbr (  \llbr x := x + y  \rrbr (\sigma))\\
		&=   \llbr y := x - y; x := x - y  \rrbr (\sigma[x \to   \llbr x + y  \rrbr (\sigma)])\\
		&=   \llbr y := x - y; x := x - y  \rrbr (\sigma[x \to x_{0} + y_{0}])\\
		&=   \llbr x := x - y  \rrbr (  \llbr y := x - y  \rrbr (\sigma[x \to x_{0} + y_{0}]))\\
		&=   \llbr x := x - y  \rrbr (\sigma[y \to x_{0} + y_{0} - y_{0}; x \to x_{0} + y_{0}])\\
	\end{align*}
	3) \underline{Variante} : on peut faire la même chose avec la multiplication et la division
	\newpage
	
	\subsection{Question 5}
	Rappel :\\
	\[
		  \llbr if\ b\ then\ i1\ else\ i2  \rrbr (\sigma) =
		\begin{cases}
			  \llbr i1  \rrbr (\sigma) si\   \llbr b  \rrbr (\sigma) = true\\
			  \llbr i2  \rrbr (\sigma) sinon\\
		\end{cases}
	\]
	
	\begin{align*}
		  \llbr if\ x1 > x2\ then\ m := x1 else\ m := x2  \rrbr (\sigma) &=
		\begin{cases}
			  \llbr m := x1  \rrbr (\sigma)\ si\   \llbr x1 > x2  \rrbr (\sigma) = true\\
			  \llbr m := x2  \rrbr (\sigma)\ sinon\\
		\end{cases}\\
		&=
		\begin{cases}
			\sigma[m \to \sigma(x1)]\ si\ \sigma(x1) > \sigma(x2)\\
			\sigma[m \to \sigma(x2)]\ sinon\\
		\end{cases}\\
		&= \sigma[m \to max(\sigma(x1), \sigma(x2))]\\
	\end{align*}
	\begin{align*}
		max : int \to int \to int&\\
		  \llbr max(x,y)  \rrbr (\sigma) &=
		\begin{cases}
			\sigma(x)\ si\ \sigma(x) > \sigma(y)\\
			\sigma(y)\ sinon\\
		\end{cases}
	\end{align*}
	
	\section{Question plus ouverte}
	
	\section{Fonctionnelles simples}
	
	\lstset{ 
		backgroundcolor=\color{white},
		basicstyle=\normalsize,
		breakatwhitespace=false,
		breaklines=true,
		captionpos=b,
		commentstyle=\color{Dandelion},
		escapeinside={\%*}{*)},
		extendedchars=true,
		frame=single,
		keepspaces=true,
		keywordstyle=\color{blue}\textbf,
		numbers=none,
		rulecolor=\color{lightgray},
		showspaces=false,
		showstringspaces=false,
		showtabs=false,
		stringstyle=\color{orange},
		tabsize=2,
		title=\lstname
	}

	\begin{lstlisting}[language=caml,caption=?]
		let rec f n = if (n = 0) then 0 else n + f(n - 1)
		(* 1 + 2 + 3 + ...*)
		(* ou bien *)
		let rec f n = if (n = 0) then 1 else n * f(n - 1)
		(* 1 * 2 * 3 * ...*)
	\end{lstlisting}
	
	Les deux définitions sont les mêmes.
	
	\paragraph{\underline{Théroème de Scott}:}
	
	Toute fonction continue F dans un domaine admet des points fixes. Le plus petit d'entre eux est $\lim \uparrow F^n(\bot)$
	
	\subsection{Point fixe de $F$}
	
	\begin{align*}
		F^{0}(\bot)(x) &= \bot\\
		F(\bot)(x) &= if\ x = 0\ then\ 0\ else\ x + \bot\\
		F(\bot)(x) &= if\ x = 0\ then\ 0\ else\ \bot\\
		F(\bot)(x) &= 	\begin{cases}
							0\ si\ x = 0\\
							\bot\ sinon\\
						\end{cases}\\
		F^{2}(\bot)(x) &= F(F(\bot))(x)\\
		&= if\ x = 0\ then\ 0\ else\ x + F(\bot)(x - 1)\\
		&= 	\begin{cases}
				0\ si\ x = 0\\
				x + F(\bot)(x - 1)\ sinon\\
			\end{cases}\\
		&= ...\\
		F^3(\bot)(x) &= F(F^2(\bot))(x)\\
		&= if\ x = 0\ then\ 0\\
		&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ x + F^2(\bot)(x - 1)\\
		&=	\begin{cases}
				0\ si\ x = 0\\
				x + F^2(\bot)(x - 1)\ sinon
			\end{cases}\\
		&=	\begin{cases}
				0\ si\ x = 0\\
				x + \begin{cases}
						0\ si\ x = 1\\
						0 + 1\ si\ x = 2\\
						\bot \ sinon\\
					\end{cases}
			\end{cases}\\
		F^3(\bot)(x) &=	\begin{cases}
							0\ si\ x = 0\\
							1 + 0\ si\ x = 1\\
							2 + 1 + 0\ si\ x = 2\\
							\bot\ sinon
						\end{cases}\\	
		F^4(\bot)(x) &=	\begin{cases}
							0\ si\ x = 0\\
							1 + 0\ si\ x = 1\\
							2 + 1 + 0\ si\ x = 2\\
							3 + 2 + 1 + 0\ si\ x = 3\\
							\bot\ sinon
						\end{cases}\\	
		F^4(\bot)(x) &= F(F^3(\bot))(x)\\
		&= if\ x = 0\ then\ 0\\
		&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ x + F^3(\bot)(x - 1)\\
		&=	\begin{cases}
				0\ si\ x = 0\\
				x + \begin{cases}
						0\ si\ x = 0\\
						1 + 0\ si\ x = 1\\
						2 + 1 + 0\ si\ x = 2\\
						\bot\ sinon\\
					\end{cases}
			\end{cases}\\
		&=	\begin{cases}
				0\ si\ x = 0\\
				x + 0\ si\ x = 1\\
				x + 1 + 0\ si\ x = 2\\
				x + 2 + 1 + 0\ si\ x = 3\\
				\bot\ sinon\\
			\end{cases}\\
	\end{align*}
	\begin{align*}
	F^4(\bot)(x) &=	\begin{cases}
						0\ si\ x = 0\\
						1 + 0\ si\ x = 1\\
						2 + 1 + 0\ si\ x = 2\\
						3 + 2 + 1 + 0\ si\ x = 3\\
						\bot\ sinon\\
					\end{cases}\\
	F^p(\bot)(x) &=	\begin{cases}
						0\ si\ x = 0\\
						1 + 0\ si\ x = 1\\
						2 + 1 + 0\ si\ x = 2\\
						3 + 2 + 1 + 0\ si\ x = 3\\
						\vdots\\
						(p - 1) + \ldots + 0\ si\ x = p - 1\\
						\bot\ sinon\\
					\end{cases}\\
	\end{align*}
	
	\subsection{Conjecture}
	
	\begin{align*}
		F^p(\bot)(x) &= \begin{cases}
							\sum_{i=0}^{x}i\ si\ x < p,\ x \in \bb{N}\\
							\bot\ sinon\\
						\end{cases}
	\end{align*}
	Montrons par récurrence sur p que cette propriété est bien vérifiée.
	
	\begin{align*}
		F^{(p+1)}(\bot)(x) &= F(F^{(p)}(\bot))(x)\\
		&= if\ x = 0\ then\ 0\\
		&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ x + F^p(\bot)(x - 1)\\
		&= if\ x = 0\ then\ 0\\
		&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ x + \begin{cases}
														\sum_{i=0}^{x- 1}i\ si\ x - 1 < p\\
														\bot\ sinon\\
													\end{cases}\\
		&=	\begin{cases}
				0\ si\ x = 0\\
				x + \sum_{i= 0}^{x - 1}i\ si\ x - 1 < p\\
				\bot\ sinon\\
			\end{cases}\\
		&=	\begin{cases}
				0\ si\ x = 0\\
				\sum_{i= 0}^{x}i\ si\ x - 1 < p\\
				\bot\ sinon\\
			\end{cases}\\
		&=	\begin{cases}
				\sum_{i= 0}^{x}i\ si\ x = 0\\
				\sum_{i= 0}^{x}i\ si\ x - 1 < p\\
				\bot\ sinon\\
			\end{cases}\\
		F^{(p + 1)}(\bot)(x) &=	\begin{cases}
									\sum_{i= 0}^{x}i\ si\ x < p + 1\\
									\bot\ sinon\\
								\end{cases}\\
	\end{align*}
	
	F est continue monotone, donc on peut appliquer le théorème de Scott.
	
	$$\lim\uparrow F^p(x) = \begin{cases}
								\sum_{i = 0}^{x}i\ si\ x \geqslant 0\\
								\bot\ sinon\\
							\end{cases}$$
	\newpage					
	\section{Boucles}
	
	\subsection{a)}
	
	\begin{align*}
		\text{Quand } \sigma(y) = 1,&\\
		while\ &x - y > 0\ do\\
			&y = 2 * y\\
	\end{align*}
	
	Calcule dans y la plus petit puissance de 2 sup ou égale à $\sigma(x)$ et laisse x inchangé.
	
	\begin{align*}
		 \llbr while\ x - y > 0\ do\ y = 2 * y  \rrbr\sigma&\\
		= si\  \llbr x - y > 0  \rrbr(\sigma) &alors  \llbr while  \llbr y = 2 * y  \rrbr(\sigma) \rrbr \circ\\
		&sinon\ \sigma
	\end{align*}
	Remarque
	\begin{align*}
	 \llbr x - y > 0  \rrbr(\sigma) &= true\\
	&=  \llbr while\ \ldots  \rrbr \circ  \llbr y = 2 * y  \rrbr(\sigma)\\
	&= \llbr while\ \ldots \rrbr \sigma [ x \to 9, y \to 2]\\
	&= \llbr while\ \ldots \rrbr \sigma [x \to 9, y \to 4]\\
	&= \llbr while\ \ldots \rrbr \sigma [x \to 9, y \to 8]\\
	&= \llbr while\ \ldots \rrbr \sigma [x \to 9, y \to 16]\\
	&= si\  \llbr x - y > 0 \rrbr (\sigma) [x \to 9, y \to 16]\ alors\ \llbr y = 2 * y \rrbr \sigma [x \to 9, y \to 16]\\
	&= \sigma [x \to 9, y \to 16]\ sinon\ \sigma ....\\
	\end{align*}
	
	
	\begin{align*}
		P &= while\ x - y > 0\ do\\
		&\ \ \ \ \ \ \ \ \ \ \ \ \ y = 2 * y\\
		\sigma(x) &= 9 \sigma(y) = 1\\
	\end{align*}
	P calcule la plus petit puissance de 2 supérieure ou égale à x.
	
	\begin{align*}
		\llbr while\ x - y > 0\ do\ y := 2 * y \rrbr (\sigma) &= ?\\
		f : X \sigma \to \llbr while\ b\ do\ X \rrbr (\sigma)&\\
		\llbr while\ x - y\ do\ y := 2 * y \rrbr(\sigma)&\\
		&=\ si\ \llbr x - y > 0 \rrbr(\sigma)\ alors\ \circled{1}\\
		&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sinon\ \sigma\\
	\end{align*}
	\begin{align*}
		\circled{1}\ &\llbr while\ x - y > 0\ do\ y := y * 2 \rrbr (\llbr y := 2 * y \rrbr) (\sigma)\\
		F : X \sigma &\to si\ \llbr x - y > 0 \rrbr (\sigma)\ alors\ (X \circ \llbr y := 2 * y \rrbr)(\sigma)\\
		&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sinon\ \sigma\\
		F(X) = X&\\
	\end{align*}
	\begin{align*}
	F^0(\bot)(\sigma) &= \bot\\
	F^1(\bot)(\sigma) &=\ si\ \llbr x - y > 0 \rrbr (\sigma)\ alors\ \bot sinon \sigma\\
	F^2(\bot)(\sigma) &= F(F(\bot))(\sigma)\\
	&=\ si\ \llbr x - y > 0 \rrbr(\sigma)\ alors\ F(\bot)(\sigma[y \to 2 \sigma(y)])\ sinon\ \sigma\\
	&=\ si\ \llbr x - y > 0 \rrbr(\sigma)\ alors\ si\ \llbr x - y > 0 \rrbr \sigma [y \to 2 \sigma(y)] alors\ \bot\ sinon\ \sigma [y \to 2 \sigma (y)]\\
	\text{On va noter } &y_0 = \sigma(y);\\
	&x_0 = \sigma(x);\\
	&x_0 - y_0 > 0;\\
	&=\ si\ x_0 - y_0 > 0\ alors\ si\ x_0 - 2y_0 > 0\ alors\ \bot\ sinon\ \sigma\\
	F^3(\bot)(\sigma) &= F(F^2(\bot))(\sigma)\\
	&=\ si\ \llbr x - y > 0 \rrbr (\sigma)\ alors\ F^2(\bot) \sigma [y \to 2 y_0]\\
	&=\ si\ x_0 - \sigma(y) > 0\ alors\\
	&\ \ \ \ \ \ \ si\ x_0 - 2 \sigma(y) > 0\ alors\\
	&\ \ \ \ \ \ \ \ \ si\ x_0 - 4 \sigma(y) > 0\ alors\ \bot\ sinon\ \sigma[y \to 4 \sigma(y)]\\
	&\ \ \ \ \ \ \ sinon\ \sigma [y \to 2 \sigma(y)]\\
	&\ \ \ sinon\ \sigma\\
	F^3(\bot)(\sigma) &= \begin{cases}
							\sigma\ si\ x_0 \leqslant \sigma(y)\\
							\sigma [y \to 2 \sigma(y)]\ si\ \sigma(y) < x_0 \leqslant 2 \sigma(y)\\
							\sigma [y \to 4 \sigma(y)]\ si\ 2 \sigma(y) < x_0 \leqslant 4 \sigma (y)\\
							\bot\ si\ 4 \sigma(y) < x_0\\
						 \end{cases}\\
	F^p(\bot)(\sigma) &= \begin{cases}
							\sigma\ si\ x_0 \leqslant \sigma(y)\\
							\sigma[y \to 2 \sigma(y)]\ si\ 2^{i-1}\sigma(y) < x_0 \leqslant 2^i \sigma(y), \ \ \ i = 1 \to p-1\\
							\bot\ si\ 2^{p-1}(\sigma(y)) < x_0\\
						 \end{cases}\\
 	F^{p+1}i(\bot)(\sigma) &=\ si\ \llbr x - y > 0 \llbr(\sigma)\ alors\ F^p(\bot)(\sigma)[y \to 2 \sigma (y)] sinon \sigma\\
 	&= \begin{cases}
		 \sigma\ si\ x_0 \leqslant \sigma(y)\\
		 \sigma[y \to 2 \sigma(y)]\ si\ x_0 \leqslant 2 \sigma(y), \ \ \ x_0 > \sigma(y)\\
		 \sigma [y \to 2^i \sigma(y)]\ si\ 2^{i - 1}\sigma(y) < x_0 \leqslant 2^i,\ \ \ i = 1 .. p\\
		 \bot\ si\ 2^{p} \sigma(y) < x_0\\
 	   \end{cases}\\
 	\lim \uparrow F^p(\bot)(\sigma) &= \begin{cases}
									 		\sigma\ si\ x_0 \leqslant y_0\\
									 		\sigma[y \to 2^i y_0]\ si\ 2^{i-1} y_0 < x_0 \leqslant 2^i y_0\\
									 	\end{cases}\\
	\end{align*}
	Remarque : on à supposé $y_0 = 1$.
\end{document}